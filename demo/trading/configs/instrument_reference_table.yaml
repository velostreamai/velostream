# Instrument Reference Data Table Configuration
# Static reference table for instrument metadata (symbols, exchange, trading rules, etc.)
# Used by Stream-Table JOIN to enrich market data with instrument properties
#
# Example: Enriching market_data with instrument-specific fields like tick_size, lot_size
# See: demo/trading/sql/financial_trading.sql:117-185 (TIER 1: STREAM-TABLE JOIN)

extends: common_table_source.yaml

# Table identity
table:
  name: instrument_reference
  type: static_lookup
  primary_key: symbol

# Data source for populating this table
# Choose one: file (CSV/JSON) or kafka (streaming table topic)
data_source:
  type: file
  path: ./demo/trading/data/instrument_reference.csv
  format: csv
  has_headers: true

# Table schema definition
schema:
  fields:
    - name: symbol
      type: string
      nullable: false
      description: "Trading symbol (e.g., AAPL, GOOGL)"

    - name: instrument_name
      type: string
      description: "Full instrument name"

    - name: isin_code
      type: string
      description: "International Securities Identification Number"

    - name: exchange
      type: string
      description: "Primary exchange (e.g., NASDAQ, NYSE)"

    - name: tick_size
      type: decimal
      precision: 10
      scale: 4
      description: "Minimum price increment for trading"

    - name: lot_size
      type: integer
      description: "Standard lot size for this instrument"

    - name: trading_venue
      type: string
      description: "Official trading venue"

    - name: settlement_currency
      type: string
      description: "Currency for settlement (e.g., USD)"

    - name: margin_requirement
      type: decimal
      precision: 5
      scale: 2
      description: "Margin requirement as percentage"

    - name: position_limit
      type: integer
      description: "Maximum position size in units"

    - name: restricted_trading_hours
      type: boolean
      description: "Whether this instrument has restricted trading hours"

# Table-specific cache configuration
cache:
  enabled: true
  ttl_seconds: 3600  # 1 hour - instruments change slowly
  refresh_interval_ms: 300000  # 5 minutes
  max_entries: 10000

# Business metadata
metadata:
  description: "Static instrument reference data with trading rules and regulatory limits"
  data.classification: "non_sensitive"
  update.frequency: "daily"
  primary_key: symbol
  use_case: "Stream-Table JOIN enrichment for market data (normalized pricing, lot calculations)"
  sla.refresh_time_seconds: 300
  owner: "Trading Operations"
