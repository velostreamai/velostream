# Firm-Wide Risk Limits Table Configuration
# Reference table for firm-wide exposure limits and concentration controls
# Used by TIER 4 ANY/ALL operators for hierarchical risk validation
#
# Example: Validating positions against firm-wide notional limits
# See: demo/trading/sql/financial_trading.sql:738-851 (TIER 4: ANY/ALL OPERATORS)

extends: common_table_source.yaml

# Table identity
table:
  name: firm_limits
  type: static_lookup
  primary_key: firm_id

# Data source for populating this table
data_source:
  type: file
  path: ./demo/trading/data/firm_limits.csv
  format: csv
  has_headers: true

# File path for the data
file:
  path: ../data/firm_limits.csv

# Table schema definition
schema:
  fields:
    - name: firm_id
      type: string
      nullable: false
      description: "Unique firm identifier"

    - name: firm_name
      type: string
      description: "Legal firm name"

    - name: firm_notional_limit
      type: decimal
      precision: 19
      scale: 2
      description: "Maximum firm-wide notional exposure"

    - name: firm_total_exposure
      type: decimal
      precision: 19
      scale: 2
      description: "Current total firm exposure"

    - name: max_concentration_ratio
      type: decimal
      precision: 5
      scale: 4
      description: "Maximum concentration ratio (% of firm exposure per position)"

    - name: max_single_position
      type: decimal
      precision: 19
      scale: 2
      description: "Maximum size of any single position"

    - name: daily_loss_hard_limit
      type: decimal
      precision: 19
      scale: 2
      description: "Daily loss hard stop limit"

    - name: risk_governance_level
      type: string
      enum: ["RETAIL", "INSTITUTIONAL", "SYSTEMIC"]
      description: "Risk governance classification level"

    - name: effective_date
      type: date
      description: "Date limits become effective"

# Table-specific cache configuration
cache:
  enabled: true
  ttl_seconds: 3600  # 1 hour - firm limits change infrequently
  refresh_interval_ms: 300000  # 5 minutes refresh
  max_entries: 100

# Business metadata
metadata:
  description: "Firm-wide exposure limits and concentration controls for enterprise risk governance"
  data.classification: "compliance_sensitive"
  update.frequency: "daily"
  primary_key: firm_id
  use_case: "ALL operator for firm-level risk validation (notional limits, concentration controls)"
  sla.refresh_time_seconds: 300
  owner: "Chief Risk Officer"
