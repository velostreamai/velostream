application: sum_avg_demo
description: Test SUM, AVG, MIN, MAX aggregations
default_timeout_ms: 60000
default_records: 100

queries:
  - name: sum_avg_output
    description: Verify aggregate functions produce correct results
    inputs:
      - source: input_stream
        schema: simple_record
        records: 100
    assertions:
      # Streaming aggregation emits updates per input record
      - type: record_count
        equals: 100
      - type: schema_contains
        fields: [active, total_amount, avg_amount, min_amount, max_amount, record_count]
      - type: no_nulls
        fields: [active, total_amount, avg_amount, min_amount, max_amount, record_count]
      # Verify aggregation values are positive
      - type: field_values
        field: record_count
        operator: greater_than
        value: 0
    timeout_ms: 60000
