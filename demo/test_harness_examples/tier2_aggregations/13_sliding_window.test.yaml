application: sliding_window_demo
description: Test sliding window aggregation
default_timeout_ms: 60000
default_records: 1000

queries:
  - name: moving_avg_5m
    description: Verify sliding window produces moving averages
    inputs:
      - source: price_feed
        schema: market_data
        records: 1000
        time_simulation:
          start_time: "-10m"   # 10 minutes - spans multiple 5-min windows with 1-min advance
          end_time: "now"
          sequential: true
    assertions:
      - type: record_count
        greater_than: 0
      - type: schema_contains
        fields: [symbol, avg_price, avg_volume, sample_count, min_price, max_price]
      - type: field_values
        field: avg_price
        operator: gte
        compare_field: min_price
      - type: field_values
        field: avg_price
        operator: lte
        compare_field: max_price
      - type: no_nulls
        fields: [symbol, avg_price, sample_count]
    timeout_ms: 60000
