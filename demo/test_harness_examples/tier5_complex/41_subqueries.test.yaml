application: subqueries_demo
description: Test subquery filtering patterns
default_timeout_ms: 60000
default_records: 200

queries:
  - name: vip_orders
    description: Verify subquery filters VIP customer orders
    dependencies:
      - vip_customers  # Reference table must be loaded first
    inputs:
      - source: all_orders
        schema: order_event
        records: 200
    assertions:
      - type: record_count
        greater_than: 0
        less_than: 200  # Should filter out non-VIP orders
      - type: schema_contains
        # Note: Fields have table alias prefix (o.) when no explicit AS alias is used
        fields: [o.order_id, o.customer_id, o.product_id, order_total, o.status]
      - type: no_nulls
        fields: [o.order_id, o.customer_id, order_total]
    timeout_ms: 60000
