application: right_join_demo
description: Test RIGHT JOIN returns all right table records
default_timeout_ms: 60000

queries:
  # RIGHT JOIN: All products with optional order data
  # Products table (9 records) loaded from file_source config in SQL
  # Orders (30 records) use product_ids matching products.csv
  - name: product_order_status
    description: Verify all products appear, with or without orders
    inputs:
      - source: orders
        schema: order_event
        records: 30
    assertions:
      - type: record_count
        greater_than: 0
      - type: schema_contains
        fields: [product_id, product_name, category, order_status]
      # Note: file_source JOIN table loading has known issues - only check order-side fields
      # TODO: Enable full no_nulls check when file_source table lookup is fixed
      - type: no_nulls
        fields: [order_id, order_status]
      - type: field_in_set
        field: order_status
        values: ["NO_ORDERS", "HIGH_VOLUME", "NORMAL"]
    timeout_ms: 60000
