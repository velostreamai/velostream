application: right_join_demo
description: Test RIGHT JOIN returns all right table records
default_timeout_ms: 30000
default_records: 50

queries:
  - name: product_order_status
    description: Verify all products appear, with or without orders
    inputs:
      - source: orders
        schema: order_record.schema.yaml
        records: 30
        # Only orders for some products
      - source: products
        schema: product_record.schema.yaml
        records: 50
        type: table
    assertions:
      - type: record_count
        greater_than_or_equal: 50    # At least all products
      - type: schema_contains
        fields: [product_id, product_name, category, order_status]
      - type: no_nulls
        fields: [product_id, product_name, category]   # Right table fields always present
      - type: field_values
        field: order_status
        contains: ["NO_ORDERS", "NORMAL"]   # Some products have no orders
    timeout_ms: 30000
