application: projection_demo
description: Test field projection and aliasing
default_timeout_ms: 30000
default_records: 100

queries:
  - name: projected_output
    description: Verify field projection and aliases work correctly
    inputs:
      - source: input_stream
        schema: simple_record
        records: 100
    assertions:
      - type: record_count
        equals: 100
      - type: schema_contains
        fields: [record_id, record_value, adjusted_amount, event_time]
      - type: no_nulls
        fields: [record_id, record_value, adjusted_amount]
    timeout_ms: 30000
